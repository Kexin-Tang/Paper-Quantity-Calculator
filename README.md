# 纸张数量测量装置

该项目为 **2019年全国大学生电子设计竞赛F题** 对应的代码

[English Version](https://github.com/Kexin-Tang/Paper-Quantity-Calculator/blob/master/README_EN.md)

# 要求
只使用两块5cm×5cm的铜板完成对任意放入铜板间的纸张进行测数，在铜板上 **只能留有两根导线**，不能附带其他物件。

# 原理
由于考虑到是铜板，且测量铜板间的物体，所以可以使用测量电容的方法。根据电容计算公式可知，电容值大小与极板间距有关，而极板间距又与纸张的张数成正比，因此可以通过电容值代表纸张数量。

由此，自然想到通过电容传感器测量电容值。

本实验使用Texas Instrument的 **FDC2214** 电容传感器，该传感器利用RLC谐振电路，通过扫频测量谐振频率从而测出C的值。

在测出C的值后，需要通过公式转换，而关键的 *介电常数* 是会根据环境进行变换的，所以在测量前安排了一个校准环节——通过手动放入纸张，收集不同纸张数对应的电容值，再通过曲线拟合，求出介电常数，辅助测量。（所以还外接了一个电容触摸屏）

#### 电路图
![FDC2214_circuit.png](https://i.loli.net/2020/09/11/13sCkpVu4Dczvt8.png)

# 文件格式

文件名   |  作用
:----:|:------:
main.c | 主函数，进入功能界面
touch  | 触摸屏函数，用于实现界面UI、触摸点检测、相应功能实现
lcd    | IO模拟IIC通信、寄存器初始化等工作
fdc2214| 电容传感器读写、数据传输等工作

### Note
* 该文件下载后无法直接使用，如果使用FPGA，需要在Vivado中设置底层的逻辑
* 如果使用MCU，需要注意修改定时器等相关外设
* 触摸屏使用 ~~国内某知名厂商~~ LCD屏幕，请注意引脚的配对关系，不要把LCD给烧咯
